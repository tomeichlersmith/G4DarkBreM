<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>G4DarkBreM: g4db::G4DarkBreMModel Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">G4DarkBreM
   &#160;<span id="projectnumber">v1.0.1</span>
   </div>
   <div id="projectbrief">Geant4 Dark Bremmstrahlung from MadGraph</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classg4db_1_1G4DarkBreMModel.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classg4db_1_1G4DarkBreMModel-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">g4db::G4DarkBreMModel Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for g4db::G4DarkBreMModel:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classg4db_1_1G4DarkBreMModel__inherit__graph.svg" width="196" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for g4db::G4DarkBreMModel:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classg4db_1_1G4DarkBreMModel__coll__graph.svg" width="1335" height="235"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structg4db_1_1G4DarkBreMModel_1_1OutgoingKinematics.html">OutgoingKinematics</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5e4e2913f791f6ca9e9693d4ce9792b6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a5e4e2913f791f6ca9e9693d4ce9792b6">G4DarkBreMModel</a> (const std::string &amp;method_name, double threshold, double epsilon, const std::string &amp;library_path, bool muons, bool load_library=true)</td></tr>
<tr class="memdesc:a5e4e2913f791f6ca9e9693d4ce9792b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the parameters for this model.  <a href="classg4db_1_1G4DarkBreMModel.html#a5e4e2913f791f6ca9e9693d4ce9792b6">More...</a><br /></td></tr>
<tr class="separator:a5e4e2913f791f6ca9e9693d4ce9792b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2ef7fbd9b88c050c8d04a226d906f81"><td class="memItemLeft" align="right" valign="top"><a id="ab2ef7fbd9b88c050c8d04a226d906f81"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#ab2ef7fbd9b88c050c8d04a226d906f81">~G4DarkBreMModel</a> ()=default</td></tr>
<tr class="memdesc:ab2ef7fbd9b88c050c8d04a226d906f81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:ab2ef7fbd9b88c050c8d04a226d906f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2405e26a0cbdacf5c5f86173f3273e9a"><td class="memItemLeft" align="right" valign="top"><a id="a2405e26a0cbdacf5c5f86173f3273e9a"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a2405e26a0cbdacf5c5f86173f3273e9a">PrintInfo</a> () const</td></tr>
<tr class="memdesc:a2405e26a0cbdacf5c5f86173f3273e9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the configuration of this model. <br /></td></tr>
<tr class="separator:a2405e26a0cbdacf5c5f86173f3273e9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb47b4204cc4536334d9ccf9f8cb845f"><td class="memItemLeft" align="right" valign="top">virtual G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#aeb47b4204cc4536334d9ccf9f8cb845f">ComputeCrossSectionPerAtom</a> (G4double lepton_ke, G4double atomicA, G4double atomicZ)</td></tr>
<tr class="memdesc:aeb47b4204cc4536334d9ccf9f8cb845f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the cross section per atom in GEANT4 internal units.  <a href="classg4db_1_1G4DarkBreMModel.html#aeb47b4204cc4536334d9ccf9f8cb845f">More...</a><br /></td></tr>
<tr class="separator:aeb47b4204cc4536334d9ccf9f8cb845f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a987a2301765d60efbab9dc669532f6cb"><td class="memItemLeft" align="right" valign="top">G4ThreeVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a987a2301765d60efbab9dc669532f6cb">scample</a> (double incident_energy, double lepton_mass)</td></tr>
<tr class="memdesc:a987a2301765d60efbab9dc669532f6cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the SCAling and saMPLE procedure to scale one of the MG events in our library to the input incident lepton energy (and mass).  <a href="classg4db_1_1G4DarkBreMModel.html#a987a2301765d60efbab9dc669532f6cb">More...</a><br /></td></tr>
<tr class="separator:a987a2301765d60efbab9dc669532f6cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af55e733c9b510ed0ced469afce610909"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#af55e733c9b510ed0ced469afce610909">GenerateChange</a> (G4ParticleChange &amp;particleChange, const G4Track &amp;track, const G4Step &amp;step)</td></tr>
<tr class="memdesc:af55e733c9b510ed0ced469afce610909"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulates the emission of a dark photon + lepton.  <a href="classg4db_1_1G4DarkBreMModel.html#af55e733c9b510ed0ced469afce610909">More...</a><br /></td></tr>
<tr class="separator:af55e733c9b510ed0ced469afce610909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classg4db_1_1PrototypeModel"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classg4db_1_1PrototypeModel')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classg4db_1_1PrototypeModel.html">g4db::PrototypeModel</a></td></tr>
<tr class="memitem:ae2308897ed541c06804cab2a0a5049b6 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#ae2308897ed541c06804cab2a0a5049b6">PrototypeModel</a> (bool muons)</td></tr>
<tr class="memdesc:ae2308897ed541c06804cab2a0a5049b6 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classg4db_1_1PrototypeModel.html#ae2308897ed541c06804cab2a0a5049b6">More...</a><br /></td></tr>
<tr class="separator:ae2308897ed541c06804cab2a0a5049b6 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae11ef65b539948079f2ccd0607bd3fe6 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top"><a id="ae11ef65b539948079f2ccd0607bd3fe6"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#ae11ef65b539948079f2ccd0607bd3fe6">~PrototypeModel</a> ()=default</td></tr>
<tr class="memdesc:ae11ef65b539948079f2ccd0607bd3fe6 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor, nothing on purpose. <br /></td></tr>
<tr class="separator:ae11ef65b539948079f2ccd0607bd3fe6 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a8433941bea20f62c3a0d96d2e8bd29b0"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8433941bea20f62c3a0d96d2e8bd29b0">DarkBremMethod</a> { <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8433941bea20f62c3a0d96d2e8bd29b0a29b453f0114ded1e0261b2b407a93838">ForwardOnly</a> = 1, 
<a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8433941bea20f62c3a0d96d2e8bd29b0a96d45cec44ea79b215379dbb96661027">CMScaling</a> = 2, 
<a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8433941bea20f62c3a0d96d2e8bd29b0a584703226d49f23eecd0937a21c7142d">Undefined</a> = 3
 }</td></tr>
<tr class="separator:a8433941bea20f62c3a0d96d2e8bd29b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae188730b3535a30556903f898abbd494"><td class="memItemLeft" align="right" valign="top"><a id="ae188730b3535a30556903f898abbd494"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#ae188730b3535a30556903f898abbd494">LorentzVector</a> = CLHEP::HepLorentzVector</td></tr>
<tr class="memdesc:ae188730b3535a30556903f898abbd494"><td class="mdescLeft">&#160;</td><td class="mdescRight">the class we use to store four vectors <br /></td></tr>
<tr class="separator:ae188730b3535a30556903f898abbd494"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ab983da9c7a78911c2ffe8e551a761ff7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#ab983da9c7a78911c2ffe8e551a761ff7">SetMadGraphDataLibrary</a> (std::string path)</td></tr>
<tr class="memdesc:ab983da9c7a78911c2ffe8e551a761ff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the library of dark brem events to be scaled.  <a href="classg4db_1_1G4DarkBreMModel.html#ab983da9c7a78911c2ffe8e551a761ff7">More...</a><br /></td></tr>
<tr class="separator:ab983da9c7a78911c2ffe8e551a761ff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a104681330bf0a85a87d69f8c9852fa1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a104681330bf0a85a87d69f8c9852fa1e">ParseLHE</a> (std::string fname)</td></tr>
<tr class="memdesc:a104681330bf0a85a87d69f8c9852fa1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse an LHE File.  <a href="classg4db_1_1G4DarkBreMModel.html#a104681330bf0a85a87d69f8c9852fa1e">More...</a><br /></td></tr>
<tr class="separator:a104681330bf0a85a87d69f8c9852fa1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d43e129542b8392ff62d502d94894b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a97d43e129542b8392ff62d502d94894b">MakePlaceholders</a> ()</td></tr>
<tr class="memdesc:a97d43e129542b8392ff62d502d94894b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill vector of currentDataPoints_ with the same number of items as the madgraph data.  <a href="classg4db_1_1G4DarkBreMModel.html#a97d43e129542b8392ff62d502d94894b">More...</a><br /></td></tr>
<tr class="separator:a97d43e129542b8392ff62d502d94894b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad78171ab7a7a8124dc101878410404ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structg4db_1_1G4DarkBreMModel_1_1OutgoingKinematics.html">OutgoingKinematics</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#ad78171ab7a7a8124dc101878410404ee">GetMadgraphData</a> (double E0)</td></tr>
<tr class="memdesc:ad78171ab7a7a8124dc101878410404ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns mad graph data given an energy [GeV].  <a href="classg4db_1_1G4DarkBreMModel.html#ad78171ab7a7a8124dc101878410404ee">More...</a><br /></td></tr>
<tr class="separator:ad78171ab7a7a8124dc101878410404ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:abaa436c1010f810fd563ff8d20df79ac"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#abaa436c1010f810fd563ff8d20df79ac">maxIterations_</a> {10000}</td></tr>
<tr class="memdesc:abaa436c1010f810fd563ff8d20df79ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum number of iterations to check before giving up on an event  <a href="classg4db_1_1G4DarkBreMModel.html#abaa436c1010f810fd563ff8d20df79ac">More...</a><br /></td></tr>
<tr class="separator:abaa436c1010f810fd563ff8d20df79ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a007e7af570949793604ada78c23508b5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a007e7af570949793604ada78c23508b5">threshold_</a></td></tr>
<tr class="memdesc:a007e7af570949793604ada78c23508b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Threshold for non-zero xsec [GeV].  <a href="classg4db_1_1G4DarkBreMModel.html#a007e7af570949793604ada78c23508b5">More...</a><br /></td></tr>
<tr class="separator:a007e7af570949793604ada78c23508b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a9be5e8ea125fb12656415cde4ad6ce"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a7a9be5e8ea125fb12656415cde4ad6ce">epsilon_</a></td></tr>
<tr class="memdesc:a7a9be5e8ea125fb12656415cde4ad6ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Epsilon value to plug into xsec calculation.  <a href="classg4db_1_1G4DarkBreMModel.html#a7a9be5e8ea125fb12656415cde4ad6ce">More...</a><br /></td></tr>
<tr class="separator:a7a9be5e8ea125fb12656415cde4ad6ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa805cbf21910370dc076d6806c89cc86"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8433941bea20f62c3a0d96d2e8bd29b0">DarkBremMethod</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#aa805cbf21910370dc076d6806c89cc86">method_</a> {DarkBremMethod::Undefined}</td></tr>
<tr class="memdesc:aa805cbf21910370dc076d6806c89cc86"><td class="mdescLeft">&#160;</td><td class="mdescRight">method for this model  <a href="classg4db_1_1G4DarkBreMModel.html#aa805cbf21910370dc076d6806c89cc86">More...</a><br /></td></tr>
<tr class="separator:aa805cbf21910370dc076d6806c89cc86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d97e48c82feb83feae73a44bd1eb326"><td class="memItemLeft" align="right" valign="top"><a id="a2d97e48c82feb83feae73a44bd1eb326"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a2d97e48c82feb83feae73a44bd1eb326">method_name_</a></td></tr>
<tr class="memdesc:a2d97e48c82feb83feae73a44bd1eb326"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of method for persisting into the RunHeader. <br /></td></tr>
<tr class="separator:a2d97e48c82feb83feae73a44bd1eb326"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa87a280a39e044f0053332e442729480"><td class="memItemLeft" align="right" valign="top"><a id="aa87a280a39e044f0053332e442729480"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#aa87a280a39e044f0053332e442729480">library_path_</a></td></tr>
<tr class="memdesc:aa87a280a39e044f0053332e442729480"><td class="mdescLeft">&#160;</td><td class="mdescRight">Full path to the vertex library used for persisting into the RunHeader. <br /></td></tr>
<tr class="separator:aa87a280a39e044f0053332e442729480"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7586dc7db133a0d01bb000bf39bdd888"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a7586dc7db133a0d01bb000bf39bdd888">alwaysCreateNewElectron_</a> {true}</td></tr>
<tr class="memdesc:a7586dc7db133a0d01bb000bf39bdd888"><td class="mdescLeft">&#160;</td><td class="mdescRight">should we always create a totally new electron when we dark brem?  <a href="classg4db_1_1G4DarkBreMModel.html#a7586dc7db133a0d01bb000bf39bdd888">More...</a><br /></td></tr>
<tr class="separator:a7586dc7db133a0d01bb000bf39bdd888"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a466770b569c7cc2952dbff5a1f38de5c"><td class="memItemLeft" align="right" valign="top">std::map&lt; double, std::vector&lt; <a class="el" href="structg4db_1_1G4DarkBreMModel_1_1OutgoingKinematics.html">OutgoingKinematics</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a466770b569c7cc2952dbff5a1f38de5c">madGraphData_</a></td></tr>
<tr class="memdesc:a466770b569c7cc2952dbff5a1f38de5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage of data from mad graph.  <a href="classg4db_1_1G4DarkBreMModel.html#a466770b569c7cc2952dbff5a1f38de5c">More...</a><br /></td></tr>
<tr class="separator:a466770b569c7cc2952dbff5a1f38de5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d7f8e9c841d4b2990172567ae87745c"><td class="memItemLeft" align="right" valign="top">std::map&lt; double, unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a5d7f8e9c841d4b2990172567ae87745c">currentDataPoints_</a></td></tr>
<tr class="memdesc:a5d7f8e9c841d4b2990172567ae87745c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores a map of current access points to mad graph data.  <a href="classg4db_1_1G4DarkBreMModel.html#a5d7f8e9c841d4b2990172567ae87745c">More...</a><br /></td></tr>
<tr class="separator:a5d7f8e9c841d4b2990172567ae87745c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classg4db_1_1PrototypeModel"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classg4db_1_1PrototypeModel')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classg4db_1_1PrototypeModel.html">g4db::PrototypeModel</a></td></tr>
<tr class="memitem:a1b3c9e9bb255805a434ba7cf99edd961 inherit pro_attribs_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top"><a id="a1b3c9e9bb255805a434ba7cf99edd961"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#a1b3c9e9bb255805a434ba7cf99edd961">muons_</a></td></tr>
<tr class="memdesc:a1b3c9e9bb255805a434ba7cf99edd961 inherit pro_attribs_classg4db_1_1PrototypeModel"><td class="mdescLeft">&#160;</td><td class="mdescRight">whether muons (true) or electrons (false) are dark bremming <br /></td></tr>
<tr class="separator:a1b3c9e9bb255805a434ba7cf99edd961 inherit pro_attribs_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Geant4 implementation of the model for a particle undergoing a dark brem where we use an imported event library to decide the outgoing kinematics.</p>
<p>This is where all the heavy lifting in terms of calculating cross sections and actually having a lepton do a dark brem occurs. This model depends on several configurable parameters.</p>
<ul>
<li>library_path : the full path to the directory containing the LHE dark brem vertices that will be read in to make the vertex library</li>
<li>epsilon : strength of the dark photon - photon mixing</li>
<li>threshold : minimum energy in GeV for the electron to have a non-zero cross section for going dark brem</li>
<li>method : scaling method to use to scale the dark brem vertices from the library to the actual electron energy when a dark brem occurs</li>
<li>whether we are dark bremming of muons or electrons</li>
</ul>
<p>The required parameter is a vertex library generated in MadGraph (library_path). </p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a8433941bea20f62c3a0d96d2e8bd29b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8433941bea20f62c3a0d96d2e8bd29b0">&#9670;&nbsp;</a></span>DarkBremMethod</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8433941bea20f62c3a0d96d2e8bd29b0">g4db::G4DarkBreMModel::DarkBremMethod</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Possible methods to use the dark brem vertices from the imported library inside of this model. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a8433941bea20f62c3a0d96d2e8bd29b0a29b453f0114ded1e0261b2b407a93838"></a>ForwardOnly&#160;</td><td class="fielddoc"><p>Use actual electron energy and get pT from LHE (such that \(p_T^2+m_l^2 &lt; E_{acc}^2\)) </p>
</td></tr>
<tr><td class="fieldname"><a id="a8433941bea20f62c3a0d96d2e8bd29b0a96d45cec44ea79b215379dbb96661027"></a>CMScaling&#160;</td><td class="fielddoc"><p>Boost LHE vertex momenta to the actual electron energy. </p>
</td></tr>
<tr><td class="fieldname"><a id="a8433941bea20f62c3a0d96d2e8bd29b0a584703226d49f23eecd0937a21c7142d"></a>Undefined&#160;</td><td class="fielddoc"><p>Use LHE vertex as is. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5e4e2913f791f6ca9e9693d4ce9792b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e4e2913f791f6ca9e9693d4ce9792b6">&#9670;&nbsp;</a></span>G4DarkBreMModel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">g4db::G4DarkBreMModel::G4DarkBreMModel </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>method_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>library_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>muons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>load_library</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the parameters for this model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">method_name</td><td>converted to an enum through a hard-coded switch statement. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">threshold</td><td>minimum energy lepton needs to have to dark brem [GeV] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">epsilon</td><td>dark photon mixing strength </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">library_path</td><td>directory in which MG library is stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">muons</td><td>true if using muons, false for electrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">load_library</td><td>only used in cross section executable where it is known that the library will not be used during program run</td></tr>
  </table>
  </dd>
</dl>
<p>The threshold is set to the maximum of the passed value or twice the A' mass (so that it kinematically makes sense).</p>
<p>The library path is immediately passed to SetMadGraphDataLibrary. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aeb47b4204cc4536334d9ccf9f8cb845f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb47b4204cc4536334d9ccf9f8cb845f">&#9670;&nbsp;</a></span>ComputeCrossSectionPerAtom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double g4db::G4DarkBreMModel::ComputeCrossSectionPerAtom </td>
          <td>(</td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>lepton_ke</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>atomicA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>atomicZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the cross section per atom in GEANT4 internal units. </p>
<p>The estimate for the total cross section given the material and the lepton's energy is done using an implementation of the WW approximation using Boost's Math Quadrature library to numerically calculate the integrals. The actual formulas are listed here for reference.</p>
<p>Since muons and electrons have such different masses, different approaches were required to create an approximation that both follows the trend produced by MG/ME and is sufficiently quick.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Electrons</h2>
<p>Because the electron mass is small, it typically suffices to calculate the effective photon flux \(\chi\) once rather than modeling its functional dependence on the \(\aprime\) energy and angle, as in the "full" WW approximation used below for muons. With electron's low mass, the Improved WW approximation can be used: </p><p class="formulaDsp">
\begin{equation} \sigma = \frac{pb}{GeV} \chi \int_0^{\min(1-m_e/E_0,1-m_A/E_0)} \frac{d\sigma}{dx}(x)dx \end{equation}
</p>
<p> where </p><p class="formulaDsp">
\begin{equation} \chi = \int^{m_A^2}_{m_A^4/(4E_0^2)} dt \left( \frac{Z^2a^4t^2}{(1+a^2t)^2(1+t/d)^2}+\frac{Za_p^4t^2}{(1+a_p^2t)^2(1+t/0.71)^8}\left(1+\frac{t(\mu_p^2-1)}{4m_p^2}\right)^2\right)\frac{t-m_A^4/(4E_0^2)}{t^2} \end{equation}
</p>
 <p class="formulaDsp">
\begin{equation} a = \frac{111.0}{m_e Z^{1/3}} \quad a_p = \frac{773.0}{m_e Z^{2/3}} \quad d = \frac{0.164}{A^{2/3}} \end{equation}
</p>
 <p class="formulaDsp">
\begin{equation} \frac{d\sigma}{dx}(x) = 4 \alpha_{EW}^3\epsilon^2 \sqrt{1-\frac{m_A^2}{E_0^2}}\frac{1-x+x^2/3}{m_A^2(1-x)/x+m_e^2x} \end{equation}
</p>
<ul>
<li>\(E_0\) is the incoming electrons's energy in GeV</li>
<li>\(m_e\) is the mass of the electron in GeV</li>
<li>\(m_A\) is the mass of the dark photon in GeV</li>
<li>\(m_p = 0.938\) is the mass of the proton in GeV</li>
<li>\(\mu_p = 2.79\) is the proton \(\mu\)</li>
<li>\(A\) is the atomic mass of the target nucleus in amu</li>
<li>\(Z\) is the atomic number of the target nucleus</li>
<li>\(\alpha_{EW} = 1/137\) is the fine-structure constant</li>
<li>\(\epsilon\) is the dark photon mixing strength the the SM photon</li>
<li>\(pb/GeV = 3.894\times10^8\) is a conversion factor from GeV to pico-barns.</li>
</ul>
<h2><a class="anchor" id="autotoc_md4"></a>
Muons</h2>
<p>The muon's greater mass motivated the use of the "full" WW but including the numerical evaluation of \(\chi\) at each point in phase space proved to be too costly. Instead, we use an analytic integration of only elastic form-factor component:</p>
<p class="formulaDsp">
\begin{equation} \sigma = \frac{pb}{GeV} \int_0^{0.3} \int_0^{\min(1-m_\mu/E_0,1-m_A/E_0)} \frac{d\sigma}{dxd\theta}~dx~d\theta \end{equation}
</p>
<p>where</p>
<p class="formulaDsp">
\begin{equation} \frac{d\sigma}{dx~d\cos\theta} = 2 \alpha_{EW}^3\epsilon^2 \sqrt{x^2E_0^2 - m_A^2}E_0(1-x) \frac{\chi(x,\theta)}{\tilde{u}^2} \mathcal{A}^2 \end{equation}
</p>
<p>and</p>
<p class="formulaDsp">
\begin{equation} \chi(x,\theta) = - \frac{Z^2(a^{-2}+d+2t_{max})}{(a^{-2}-d)^3}\left( \frac{(a^{-2}-d)(t_{max}-t_{min})}{(a^{-2}+t_{max})(d+t_{max})} + \log\left(\frac{(a^{-2}+t_{max})(d+t_{min})}{(a^{-2}+t_{min})(d+t_{max})}\right) \right) \end{equation}
</p>
 <p class="formulaDsp">
\begin{equation} \mathcal{A}^2 = 2\frac{2-2x+x^2}{1-x}+\frac{4(m_A^2+2m_\mu^2)}{\tilde{u}^2}(\tilde{u}x + m_A^2(1-x) + m_\mu^2x^2) \end{equation}
</p>
 <p class="formulaDsp">
\begin{equation} \tilde{u} = -xE_0^2\theta^2 - m_A^2\frac{1-x}{x} - m_\mu^2x \end{equation}
</p>
 <p class="formulaDsp">
\begin{equation} t_{min} = \left(\frac{\tilde{u}}{2E_0(1-x)}\right)^2 \qquad t_{max} = E_0^2 \end{equation}
</p>
<p> and \(m_\mu\) is the mass of the muon in GeV, and the other symbols are the same as the electron case.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lepton_ke</td><td>kinetic energy of incoming particle </td></tr>
    <tr><td class="paramname">atomicZ</td><td>atomic number of atom </td></tr>
    <tr><td class="paramname">atomicA</td><td>atomic mass of atom </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>cross section (0. if outside energy cuts) </dd></dl>

<p>Implements <a class="el" href="classg4db_1_1PrototypeModel.html#a10064d2beb6c3fb0e2a521ca42a850ea">g4db::PrototypeModel</a>.</p>

</div>
</div>
<a id="af55e733c9b510ed0ced469afce610909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af55e733c9b510ed0ced469afce610909">&#9670;&nbsp;</a></span>GenerateChange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void g4db::G4DarkBreMModel::GenerateChange </td>
          <td>(</td>
          <td class="paramtype">G4ParticleChange &amp;&#160;</td>
          <td class="paramname"><em>particleChange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4Track &amp;&#160;</td>
          <td class="paramname"><em>track</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4Step &amp;&#160;</td>
          <td class="paramname"><em>step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Simulates the emission of a dark photon + lepton. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a987a2301765d60efbab9dc669532f6cb" title="Perform the SCAling and saMPLE procedure to scale one of the MG events in our library to the input in...">scample</a> for how the event library is sampled and scaled to the incident lepton's actual energy</dd></dl>
<p>After calling scample, we rotate the outgoing lepton's momentum to the frame of the incident particle and then calculate the dark photon's momentum such that three-momentum is conserved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">particleChange</td><td>structure holding changes to make to particle track </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">track</td><td>current track being processesed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">step</td><td>current step of the track </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classg4db_1_1PrototypeModel.html#a5023399bd69f3b9bc2ba611766ed069e">g4db::PrototypeModel</a>.</p>

</div>
</div>
<a id="ad78171ab7a7a8124dc101878410404ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad78171ab7a7a8124dc101878410404ee">&#9670;&nbsp;</a></span>GetMadgraphData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structg4db_1_1G4DarkBreMModel_1_1OutgoingKinematics.html">G4DarkBreMModel::OutgoingKinematics</a> g4db::G4DarkBreMModel::GetMadgraphData </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>E0</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns mad graph data given an energy [GeV]. </p>
<p>Gets the energy fraction and Pt from the imported LHE data. E0 should be in GeV, returns the total energy and Pt in GeV. Scales from the closest imported beam energy above the given value (scales down to avoid biasing issues).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">E0</td><td>energy of particle undergoing dark brem [GeV] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>total energy and transverse momentum of particle [GeV] </dd></dl>

</div>
</div>
<a id="a97d43e129542b8392ff62d502d94894b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97d43e129542b8392ff62d502d94894b">&#9670;&nbsp;</a></span>MakePlaceholders()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void g4db::G4DarkBreMModel::MakePlaceholders </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fill vector of currentDataPoints_ with the same number of items as the madgraph data. </p>
<p>Randomly choose a starting point so that the simulation run isn't dependent on the order of LHE vertices in the library. </p>

</div>
</div>
<a id="a104681330bf0a85a87d69f8c9852fa1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a104681330bf0a85a87d69f8c9852fa1e">&#9670;&nbsp;</a></span>ParseLHE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void g4db::G4DarkBreMModel::ParseLHE </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>fname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse an LHE File. </p>
<p>Parses an LHE file to extract the kinetic energy fraction and pt of the outgoing electron in each event. Loads the two numbers from every event into a map of vectors of pairs (mgdata). Map is keyed by energy, vector pairs are energy fraction + pt. Also creates an list of energies and placeholders (energies), so that different energies can be looped separately.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>name of LHE file to parse </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a987a2301765d60efbab9dc669532f6cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a987a2301765d60efbab9dc669532f6cb">&#9670;&nbsp;</a></span>scample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G4ThreeVector g4db::G4DarkBreMModel::scample </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>incident_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lepton_mass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the SCAling and saMPLE procedure to scale one of the MG events in our library to the input incident lepton energy (and mass). </p>
<p>This is also helpful for testing the scaling procedure in its own executable separate from the Geant4 infrastructure.</p>
<dl class="section note"><dt>Note</dt><dd>The vector returned is relative to the incident lepton as if it came in along the z-axis.</dd></dl>
<p>Gets an energy fraction and Pt from madgraph files. The scaling of this energy fraction and Pt to the actual electron energy depends on the input method.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Forward Only</h2>
<p>Scales the energy so that the fraction of kinectic energy is constant, keeps the Pt constant. If the Pt is larger than the new energy, that event is skipped, and a new one is taken from the file. Chooses the Pz of the recoil electron to always be positive.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
CM Scaling</h2>
<p>Scale MadGraph vertex to actual energy of electron using Lorentz boosts, and then extract the momentum from that.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Undefined</h2>
<p>Don't scale the MadGraph vertex to the actual energy of the electron.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">incident_energy</td><td>incident total energy of the lepton [GeV] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lepton_mass</td><td>mass of incident lepton [GeV] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>G4ThreeVector representing the recoil lepton's outgoing momentum </dd></dl>

</div>
</div>
<a id="ab983da9c7a78911c2ffe8e551a761ff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab983da9c7a78911c2ffe8e551a761ff7">&#9670;&nbsp;</a></span>SetMadGraphDataLibrary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void g4db::G4DarkBreMModel::SetMadGraphDataLibrary </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the library of dark brem events to be scaled. </p>
<p>This function loads the directory of LHE files passed into our in-memory library of events to be sampled from.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>path to directory of LHE files </td></tr>
  </table>
  </dd>
</dl>
<p>print status to user so they know what's happening</p>
<p>Print out loaded MG library std::cout &lt;&lt; "MadGraph Library of Dark Brem Events:\n"; for (const auto &amp;kV : madGraphData_) { std::cout &lt;&lt; "\t" &lt;&lt; std::setw(8) &lt;&lt; kV.first &lt;&lt; " GeV Beam -&gt; " &lt;&lt; std::setw(6) &lt;&lt; kV.second.size() &lt;&lt; " Events\n" } std::cout &lt;&lt; std::flush;</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7586dc7db133a0d01bb000bf39bdd888"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7586dc7db133a0d01bb000bf39bdd888">&#9670;&nbsp;</a></span>alwaysCreateNewElectron_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool g4db::G4DarkBreMModel::alwaysCreateNewElectron_ {true}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>should we always create a totally new electron when we dark brem? </p>
<dl class="section note"><dt>Note</dt><dd>make this configurable? I (Tom E) can't think of a reason NOT to have it... The alternative is to allow Geant4 to decide when to make a new particle by checking if the resulting kinetic energy is below some threshold. </dd></dl>

</div>
</div>
<a id="a5d7f8e9c841d4b2990172567ae87745c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d7f8e9c841d4b2990172567ae87745c">&#9670;&nbsp;</a></span>currentDataPoints_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;double, unsigned int&gt; g4db::G4DarkBreMModel::currentDataPoints_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stores a map of current access points to mad graph data. </p>
<p>Maps incoming electron energy to the index of the data vector that we will get the data from.</p>
<p>Also sorts the incoming electron energy so that we can find the sampling energy that is closest above the actual incoming energy. </p>

</div>
</div>
<a id="a7a9be5e8ea125fb12656415cde4ad6ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a9be5e8ea125fb12656415cde4ad6ce">&#9670;&nbsp;</a></span>epsilon_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double g4db::G4DarkBreMModel::epsilon_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Epsilon value to plug into xsec calculation. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classg4db_1_1G4DarkBreMModel.html#aeb47b4204cc4536334d9ccf9f8cb845f" title="Calculates the cross section per atom in GEANT4 internal units.">ComputeCrossSectionPerAtom</a> for how this is used</dd></dl>
<p>Configurable with 'epsilon' </p>

</div>
</div>
<a id="a466770b569c7cc2952dbff5a1f38de5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a466770b569c7cc2952dbff5a1f38de5c">&#9670;&nbsp;</a></span>madGraphData_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;double, std::vector&lt;<a class="el" href="structg4db_1_1G4DarkBreMModel_1_1OutgoingKinematics.html">OutgoingKinematics</a>&gt; &gt; g4db::G4DarkBreMModel::madGraphData_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage of data from mad graph. </p>
<p>Maps incoming electron energy to various options for outgoing kinematics. This is a hefty map and is what stores <b>all</b> of the vertices imported from the LHE library of dark brem vertices.</p>
<p>Library is read in from configuration parameter 'darkbrem.madgraphlibrary' </p>

</div>
</div>
<a id="abaa436c1010f810fd563ff8d20df79ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaa436c1010f810fd563ff8d20df79ac">&#9670;&nbsp;</a></span>maxIterations_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int g4db::G4DarkBreMModel::maxIterations_ {10000}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>maximum number of iterations to check before giving up on an event </p>
<p>This is only used in the ForwardOnly scaling method and is only reached if the event library energies are not appropriately matched with the energy range of particles that are existing in the simulation. </p>

</div>
</div>
<a id="aa805cbf21910370dc076d6806c89cc86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa805cbf21910370dc076d6806c89cc86">&#9670;&nbsp;</a></span>method_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8433941bea20f62c3a0d96d2e8bd29b0">DarkBremMethod</a> g4db::G4DarkBreMModel::method_ {DarkBremMethod::Undefined}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>method for this model </p>
<p>Configurable with 'method' </p>

</div>
</div>
<a id="a007e7af570949793604ada78c23508b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a007e7af570949793604ada78c23508b5">&#9670;&nbsp;</a></span>threshold_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double g4db::G4DarkBreMModel::threshold_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Threshold for non-zero xsec [GeV]. </p>
<p>Configurable with 'threshold'. At minimum, it is always at least twice the dark photon mass. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/G4DarkBreM/<a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a></li>
<li>src/G4DarkBreM/G4DarkBreMModel.cxx</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>g4db</b></li><li class="navelem"><a class="el" href="classg4db_1_1G4DarkBreMModel.html">G4DarkBreMModel</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
